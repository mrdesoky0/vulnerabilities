# Ultimate IDOR Testing Checklist (Plain GitHub Version)

## Phase 1: Setup & Target Identification

- [ ] Create two accounts (Attacker and Victim) for safe testing of destructive requests (POST/PUT/DELETE).
- [ ] Identify JSON endpoints instead of rendered HTML.
- [ ] Target critical functions first: password reset, account recovery, financial data, DMs, user management.
- [ ] Check if endpoints are private/public and contain ID parameters.
- [ ] Look for IDs leaked via other endpoints or public pages.
- [ ] Collect all web/mobile clients, APIs (swagger/openapi, jadx/apktool).

---

## Phase 2: Direct ID Substitution & Enumeration

- **Basic ID Flip:**
  ```bash
  GET /api/v5/users/10 → GET /api/v5/users/9
  ```
- **Incremental Numeric Brute Force:** Loop over numeric IDs.
- **Non-Numeric Substitution:** Replace with email, username, or UUID.
- **Complex ID Brute Force:** Try small alphanumeric variations (1–4 chars).
- **Predictable/Combined IDs:** Example: `/user/2222/data/3333` → change one or both parts.
- **Hashed/Derived IDs:** Detect MD5/SHA patterns and infer mapping.

---

## Phase 3: Path and URL Manipulation Bypasses

- Trailing Slash: `/api/v5/users/9/`
- Double Slashes: `/api/v5/users//9`
- Case Variation: `/api/User?id=123` vs `/api/user?id=123`
- Path Traversal: `/users/delete/my_id/../victim_id`
- Wildcard Path: `/api/users/*`
- Fuzz Keyword: `/api/v3/users/all`
- SQLi Quick Test: `/api/v3/users/12345'`

---

## Phase 4: Logic & Endpoint Bypasses

- Version Downgrading:
  ```bash
  GET /v3/user/111 → GET /v1/user/111
  ```
- Sub-endpoint variants: compare profile vs detail endpoints.
- Missing function-level access: `/admin/profile` → `/Admin/profile`
- Owner/role flag differences: toggle `"owner": true`, `"is_admin"`, `"role": "admin"`.
- Token swap tests with victim or other known tokens.
- Cache/role check bypass: relogin and retest.
- Token binding flaws: reuse tokens across different resources.
- Frontend-backend desync: perform backend actions hidden in UI.

---

## Phase 5: Parameter & Body Abuse

- Add extra parameters: `/api_v1/messages?user_id=victim_uuid`
- Multi-ID values: `/api/users?id=10,9`
- Alternate separators: `{"Account": 2222;1111}`
- HTTP Parameter Pollution (HPP): `?user_id=10&user_id=9`
- JSON array/object wrap:
  ```json
  {"userid":[123]}
  {"userid":{"userid":123}}
  ```
- JSON pollution:
  ```json
  {"userid":1234,"userid":2542}
  ```
- Null termination: `/api/users/9%00`
- Control char encoding: `%0d%0a`
- Replace param name: `album_id` → `account_id`
- Batch ID injection:
  ```json
  {"ids":[111,222,333]}
  ```
- Deserialization/object injection:
  ```json
  {"user":{"id":9,"role":"admin"}}
  ```

---

## Phase 6: Encoding, Hashing, and Obfuscation

- Leading zeros: `/api/users/009`
- `%20` encoding: `/api/users/9%20`
- Type confusion: `/api/users/"9"`
- Base64 encode/decode IDs.
- Detect hashed IDs (MD5/SHA/hex).
- Replace hashed IDs with crafted variants.

---

## Phase 7: Protocol & Data Format Changes

- Change HTTP methods (GET→POST→DELETE).
- Change file types: `.json` → `.xml` → `.txt`
- Change `Content-Type`: `application/json`, `application/x-www-form-urlencoded`, `application/xml`
- Add header: `X-HTTP-Method-Override: DELETE`
- Test gRPC/protobuf message manipulation (e.g., `user_id` substitution).

---

## Phase 8: Encoding & Injection Payloads

Examples to test encoding and splitting:

```bash
{"id":2222%0d%0a1111}
{"id":2222%001111}
{"id":2222;1111}
{"id":2222,1111}
{"id":2222&1111}
{"id":2222#1111}
```

---

## Phase 9: Advanced Techniques & Monitoring

- Header/Proxy Bypass: `X-Original-URL`, `X-Rewrite-URL`
- X-Forwarded-For/IP Bypass.
- Blind IDOR: monitor victim-triggered actions (emails, receipts).
- GraphQL IDOR:
  ```graphql
  query { user(id:111) { email } }
  ```
- Role/Owner Enumeration: fuzz for `is_admin`, `role`, `owner` fields.
- Weak UUID patterns: brute-force prefix/suffix.
- WebSocket subscriptions: try subscribing to `user_<id>` channels.
- TOCTOU / Race conditions: parallel requests for timing exploitation.

---

## Phase 10: Enumeration & Automation

```bash
ffuf -u https://target/api/user/FUZZ -w ids.txt -H "Authorization: Bearer <token>"
```

- Turbo Intruder / Burp Intruder for numeric/UUID fuzzing.
- Arjun / ParamMiner for hidden params.

---

## Phase 11: Detecting False Negatives

- [ ] Compare content-length and body fields (not just status codes).
- [ ] Retry after logout/login.
- [ ] Test multiple HTTP methods for same object.
- [ ] Check for frontend-only role checks.
- [ ] Test batch and multi-id requests.
- [ ] Include WebSocket/gRPC endpoints.

---

## Phase 12: Quick Prioritization

1. Exposed PII / financial endpoints.
2. Export / download endpoints.
3. Write/modify (PUT, PATCH, DELETE).
4. Batch / multi-id endpoints.
5. GraphQL / mobile / gRPC / WebSocket APIs.
6. Predictable IDs or weak UUIDs.
